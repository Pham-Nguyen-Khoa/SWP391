extends ../../layouts/default.pug
include ../../mixins/alert.pug
include ../../mixins/mixin-title.pug

block main
    +alert-success("5000")
    +alert-error('5000')
    +title("Hồ sơ dịch vụ")
    //- pre
    //-   code #{JSON.stringify(listAppointment,null,2)}
    .card.mb-3(style="margin: 0 50px 50px;")
      .card-header Bộ lọc 
      .card-body 
        .row 
          .col-6
            a(
              href=`/doctor/appointment`
                class=`btn btn-sm ml-1 btn-outline-success `
                button-filter
                button-all
              ) Tất cả (#{listAppointmentOrigin.length})
            a(
              href=`/doctor/appointment?process=ready`
                class=`btn btn-sm ml-1 btn-outline-success  `
                button-filter
              ) Sẵn sàng (#{listAppointmentOrigin.filter(a => a.Process === 'Ready').length})
            a(
              href=`/doctor/appointment?process=process`
                class=`btn btn-sm ml-1 btn-outline-success  `
                button-filter
              ) Đang thực hiện (#{listAppointmentOrigin.filter(a => a.Process === 'Process').length})
            a(
              href=`/doctor/appointment?process=successed`
                class=`btn btn-sm ml-1 btn-outline-success  `
                button-filter
              ) Hoàn thành (#{listAppointmentOrigin.filter(a => a.Process === 'Successed').length})
          .col-6
            form#filterForm(action="/doctor/appointment" method="GET")
              .form-group
                label(for="dateFilter") Lọc theo ngày:
                input.form-control(type="date" id="dateFilter" name="date")
              .form-group
                label(for="sortOrder") Sắp xếp theo:
                select.form-control(id="sortOrder" name="sort")
                  option(value="asc") Tăng dần
                  option(value="desc") Giảm dần
              button.btn(type="submit" style="background-color: #21a0b3; color: white;") Áp dụng
           
    table.table#table-appointment
        thead
            tr
                th Mã đơn hàng
                th Tên khách hàng
                th Dịch vụ
                th Ngày hẹn
                th Trạng Thái
                th Chi tiết lịch hẹn
        tbody
            each appointment in listAppointment
                
                tr 
                    td #{appointment.AppointmentID}
                    td #{appointment.NameCustomer}    
                    td #{appointment.Name}
                    td #{appointment.DateFormat}
                    td  
                        if(appointment.Process == "Ready" && appointment.ServiceID == "DV0003")
                            a(href=`/doctor/appointment/change-process/${appointment.AppointmentID}/successed` class="btn btn-primary")  Sẵn sàng
                        if(appointment.Process == "Ready" && appointment.ServiceID != "DV0003")
                            a(href=`/doctor/appointment/change-process/${appointment.AppointmentID}/process` class="btn btn-primary")  Sẵn sàng
                        else if(appointment.Process == "Process")
                            span(class="btn btn-dark") Đang thực hiện 
                        else if(appointment.Process == "Cancelled")
                            span(class="btn btn-danger") Hủy bỏ
                        else if(appointment.Process == "Successed")
                            span(class="btn btn-success") Thành công 
                    td 
                        a(href=`/doctor/appointment/detail/${appointment.AppointmentID}` class="btn btn-info") 
                          i(class="fa-solid fa-receipt")
                        
                          

    

